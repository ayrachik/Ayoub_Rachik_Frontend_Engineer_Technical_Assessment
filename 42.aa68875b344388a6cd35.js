(self.webpackChunknecktie_doctor=self.webpackChunknecktie_doctor||[]).push([[42],{42:(o,t,n)=>{"use strict";n.r(t),n.d(t,{DoctorDetailsPageModule:()=>w});var i=n(649),e=n(665);const r=o=>{var t,n;const i=null===(t=o.get("openingHour"))||void 0===t?void 0:t.value,e=+(null===(n=o.get("start"))||void 0===n?void 0:n.value);return i&&e?e>=+(null==i?void 0:i.start)&&e<=+(null==i?void 0:i.end)?null:{outsideOpeningHour:!0}:null};var s=n(639);class c{constructor(o,t,n,i,e,r){this.id=o,this.name=t,this.start=n,this.doctorId=i,this.date=e,this.status=r}}var a=n(4168),u=n(2340),l=n(1841);let g=(()=>{class o{constructor(o){this.hhtp=o}book(o,t){const n=`${u.N.apiUrl}/booking`,i=this.formToBooking(o,t);return this.hhtp.post(n,i)}formToBooking(o,t){const n=(0,a.D)(o.openingHour.day),i=(new Date).getDay(),e=new Date;if(n===i)+o.start<(new Date).getHours()&&e.setDate(e.getDate()+7);else{const o=n-i<0?7-(n-i):n-i;e.setDate(e.getDate()+o)}return new c(null,o.name,+o.start,t.id,e.toISOString().split("T")[0],null)}}return o.\u0275fac=function(t){return new(t||o)(s.LFG(l.eN))},o.\u0275prov=s.Yz7({token:o,factory:o.\u0275fac,providedIn:"root"}),o})();var d=n(3083),p=n(8583);function Z(o,t){if(1&o&&(s.TgZ(0,"ion-select-option",17),s._uU(1),s.qZA()),2&o){const o=t.$implicit;s.Q6J("value",o),s.xp6(1),s.lnq("",o.day," ",o.start," - ",o.end," ")}}function m(o,t){1&o&&(s.TgZ(0,"div",18),s._uU(1," Please choose a day. "),s.qZA())}function h(o,t){if(1&o&&(s.TgZ(0,"div",18),s._uU(1),s.qZA()),2&o){const o=s.oxw(3);s.xp6(1),s.AsE(" Choose an hour between ",null==o.openingHour||null==o.openingHour.value?null:o.openingHour.value.start," and ",null==o.openingHour||null==o.openingHour.value?null:o.openingHour.value.end,". ")}}function f(o,t){1&o&&(s.TgZ(0,"div",18),s._uU(1," Please choose an hour. "),s.qZA())}function b(o,t){1&o&&(s.TgZ(0,"div",18),s._uU(1," Please enter your name. "),s.qZA())}function q(o,t){if(1&o){const o=s.EpF();s.TgZ(0,"form",9),s.TgZ(1,"ion-item"),s.TgZ(2,"ion-label"),s._uU(3,"Day"),s.qZA(),s.TgZ(4,"ion-select",10),s.NdJ("ionChange",function(){return s.CHM(o),s.oxw(2).onOpneingHourInput()}),s.YNc(5,Z,2,4,"ion-select-option",11),s.qZA(),s.qZA(),s.TgZ(6,"div",12),s.YNc(7,m,2,0,"div",13),s.qZA(),s.TgZ(8,"ion-item"),s.TgZ(9,"ion-label",14),s._uU(10,"Hour"),s.qZA(),s.TgZ(11,"ion-input",15),s.NdJ("ionChange",function(){return s.CHM(o),s.oxw(2).onOpneingHourInput()}),s.qZA(),s.qZA(),s.TgZ(12,"div",12),s.YNc(13,h,2,2,"div",13),s.YNc(14,f,2,0,"div",13),s.qZA(),s.TgZ(15,"ion-item"),s.TgZ(16,"ion-label",14),s._uU(17,"Name"),s.qZA(),s._UZ(18,"ion-input",16),s.qZA(),s.TgZ(19,"div",12),s.YNc(20,b,2,0,"div",13),s.qZA(),s.qZA()}if(2&o){const o=s.oxw(2);s.Q6J("formGroup",o.bookingForm),s.xp6(1),s.ekj("invalid",o.openingHour.errors&&o.openingHour.touched),s.xp6(4),s.Q6J("ngForOf",o.doctor.opening_hours),s.xp6(2),s.Q6J("ngIf",o.openingHour.hasError("required")&&o.openingHour.touched),s.xp6(1),s.ekj("invalid",o.start.errors&&o.start.touched),s.xp6(5),s.Q6J("ngIf",o.start.invalid&&!o.start.hasError("required")&&o.start.touched),s.xp6(1),s.Q6J("ngIf",o.start.hasError("required")&&o.start.touched),s.xp6(1),s.ekj("invalid",o.name.errors&&o.name.touched),s.xp6(5),s.Q6J("ngIf",o.name.hasError("required")&&o.name.touched)}}function v(o,t){if(1&o&&(s.TgZ(0,"ion-card"),s.TgZ(1,"ion-card-title",7),s._uU(2),s.qZA(),s.TgZ(3,"ion-card-subtitle"),s._uU(4),s.qZA(),s.TgZ(5,"ion-card-subtitle"),s._uU(6),s.qZA(),s.TgZ(7,"ion-card-subtitle"),s._uU(8),s.qZA(),s.TgZ(9,"ion-card-content"),s.YNc(10,q,21,12,"form",8),s.qZA(),s.qZA()),2&o){const o=s.oxw();s.xp6(2),s.Oqu(o.doctor.name),s.xp6(2),s.Oqu(o.doctor.address.district),s.xp6(2),s.Oqu(o.doctor.address.line_1),s.xp6(2),s.Oqu(o.doctor.address.line_2),s.xp6(2),s.Q6J("ngIf",o.bookingForm)}}let A=(()=>{class o{constructor(o,t,n,i,e,r){this.fb=o,this.bookingService=t,this.modalCrtl=n,this.toastCrtl=i,this.router=e,this.loadingCrtl=r}get name(){return this.bookingForm.get("name")}get openingHour(){return this.bookingForm.get("openingHour")}get start(){return this.bookingForm.get("start")}ngOnInit(){this.initForm()}ngOnDestroy(){this.bookingSub&&this.bookingSub.unsubscribe()}close(){this.modalCrtl.dismiss().then()}book(){this.bookingForm.invalid||this.loadingCrtl.create({message:"Creating booking..."}).then(o=>{o.present(),this.bookingSub=this.bookingService.book(this.bookingForm.value,this.doctor).subscribe(o=>{this.modalCrtl.dismiss(o).then(),this.router.navigate(["doctor"]),this.toastCrtl.create({message:"Your booking has been created successfully.",duration:1e4,buttons:[{side:"end",text:"OK",role:"cancel"}]}).then(o=>o.present())},t=>{this.toastCrtl.create({message:"An error occured when creating your booking, please book another day.",duration:1e4,buttons:[{side:"end",text:"OK",role:"cancel"}]}).then(o=>o.present()),o.dismiss()},()=>{o.dismiss()})})}onOpneingHourInput(){this.bookingForm.hasError("outsideOpeningHour")?(this.start.setErrors([{outsideOpeningHour:!0}]),this.openingHour.setErrors([{outsideOpeningHour:!0}])):(this.start.setErrors(null),this.openingHour.setErrors(null))}initForm(){this.bookingForm=this.fb.group({name:["",[e.kI.required]],openingHour:[null,[e.kI.required]],start:[null,[e.kI.required]]},{validators:r})}}return o.\u0275fac=function(t){return new(t||o)(s.Y36(e.qu),s.Y36(g),s.Y36(d.IN),s.Y36(d.yF),s.Y36(i.F0),s.Y36(d.HT))},o.\u0275cmp=s.Xpm({type:o,selectors:[["app-booking-modal"]],inputs:{doctor:"doctor"},decls:16,vars:2,consts:[["color","primary"],["slot","primary"],[3,"click"],["name","close","slot","icon-only"],["size","12","size-sm","8","offset-sm","2",1,"ion-text-center"],[4,"ngIf"],["color","primary",3,"disabled","click"],[1,"ion-margin-top"],[3,"formGroup",4,"ngIf"],[3,"formGroup"],["placeholder","Select One","formControlName","openingHour",3,"ionChange"],[3,"value",4,"ngFor","ngForOf"],[1,"validation-errors"],["class","error-message",4,"ngIf"],["position","floating"],["type","text","formControlName","start",3,"ionChange"],["type","text","formControlName","name"],[3,"value"],[1,"error-message"]],template:function(o,t){1&o&&(s.TgZ(0,"ion-header"),s.TgZ(1,"ion-toolbar",0),s.TgZ(2,"ion-buttons",1),s.TgZ(3,"ion-button",2),s.NdJ("click",function(){return t.close()}),s._UZ(4,"ion-icon",3),s.qZA(),s.qZA(),s.TgZ(5,"ion-title"),s._uU(6,"Book a doctor"),s.qZA(),s.qZA(),s.qZA(),s.TgZ(7,"ion-content"),s.TgZ(8,"ion-grid"),s.TgZ(9,"ion-row"),s.TgZ(10,"ion-col",4),s.YNc(11,v,11,5,"ion-card",5),s.qZA(),s.qZA(),s.TgZ(12,"ion-row"),s.TgZ(13,"ion-col",4),s.TgZ(14,"ion-button",6),s.NdJ("click",function(){return t.book()}),s._uU(15,"BOOK "),s.qZA(),s.qZA(),s.qZA(),s.qZA(),s.qZA()),2&o&&(s.xp6(11),s.Q6J("ngIf",t.doctor),s.xp6(3),s.Q6J("disabled",t.bookingForm.invalid||t.bookingForm.untouched))},directives:[d.Gu,d.sr,d.Sm,d.YG,d.gu,d.wd,d.W2,d.jY,d.Nd,d.wI,p.O5,d.PM,d.gZ,d.tO,d.FN,e._Y,e.JL,e.sg,d.Ie,d.Q$,d.t9,d.QI,e.JJ,e.u,p.sg,d.pK,d.j9,d.n0],styles:[".validation-errors[_ngcontent-%COMP%]{font-size:small;color:var(--ion-color-danger,#f1453d)}ion-item.invalid[_ngcontent-%COMP%]{--highlight-background:var(--ion-color-danger,#f1453d)}ion-item[_ngcontent-%COMP%]{--highlight-color-invalid:var(--ion-color-primary)}.error-message[_ngcontent-%COMP%]{margin-top:.5rem}"]}),o})();var T=n(1280);function k(o,t){1&o&&s._UZ(0,"ion-spinner",6)}function x(o,t){1&o&&s._UZ(0,"ion-icon",11)}function _(o,t){1&o&&s._UZ(0,"ion-icon",12)}function O(o,t){if(1&o&&(s.TgZ(0,"ion-item"),s.YNc(1,x,1,0,"ion-icon",9),s.YNc(2,_,1,0,"ion-icon",10),s.TgZ(3,"ion-label"),s._uU(4),s.qZA(),s.qZA()),2&o){const o=t.$implicit;s.xp6(1),s.Q6J("ngIf",!o.isClosed),s.xp6(1),s.Q6J("ngIf",o.isClosed),s.xp6(2),s.lnq("",o.day," ",o.start," - ",o.end," ")}}function I(o,t){if(1&o&&(s.TgZ(0,"ion-card"),s.TgZ(1,"ion-card-title",7),s._uU(2),s.qZA(),s.TgZ(3,"ion-card-subtitle"),s._uU(4),s.qZA(),s.TgZ(5,"ion-card-subtitle"),s._uU(6),s.qZA(),s.TgZ(7,"ion-card-subtitle"),s._uU(8),s.qZA(),s.TgZ(9,"ion-card-content"),s.TgZ(10,"ion-list"),s.YNc(11,O,5,5,"ion-item",8),s.qZA(),s.qZA(),s.qZA()),2&o){const o=s.oxw();s.xp6(2),s.Oqu(o.doctor.name),s.xp6(2),s.Oqu(o.doctor.address.district),s.xp6(2),s.Oqu(o.doctor.address.line_1),s.xp6(2),s.Oqu(o.doctor.address.line_2),s.xp6(3),s.Q6J("ngForOf",o.doctor.opening_hours)}}function y(o,t){if(1&o){const o=s.EpF();s.TgZ(0,"ion-row"),s.TgZ(1,"ion-col",3),s.TgZ(2,"ion-button",13),s.NdJ("click",function(){s.CHM(o);const t=s.oxw();return t.book(t.doctor)}),s._uU(3," BOOK "),s.qZA(),s.qZA(),s.qZA()}}const H=[{path:"",component:(()=>{class o{constructor(o,t,n){this.activatedRoute=o,this.doctorService=t,this.modalCrtl=n,this.isLoading=!1}ngOnInit(){this.getDoctor()}ngOnDestroy(){this.doctorSub&&this.doctorSub.unsubscribe()}book(o){this.modalCrtl.create({component:A,componentProps:{doctor:o}}).then(o=>o.present())}getDoctor(){this.isLoading=!0,this.activatedRoute.paramMap.subscribe(o=>{const t=o.get("doctorId");this.doctorSub=this.doctorService.getDoctorById(t).subscribe(o=>this.doctor=o,o=>{},()=>this.isLoading=!1)})}}return o.\u0275fac=function(t){return new(t||o)(s.Y36(i.gz),s.Y36(T.O),s.Y36(d.IN))},o.\u0275cmp=s.Xpm({type:o,selectors:[["app-doctor-details"]],decls:13,vars:3,consts:[["color","primary"],["slot","start"],["defaultHref","/doctor"],["size","12","size-sm","8","offset-sm","2",1,"ion-text-center"],["class","ion-margin-top","color","primary",4,"ngIf"],[4,"ngIf"],["color","primary",1,"ion-margin-top"],[1,"ion-margin-top"],[4,"ngFor","ngForOf"],["class","ion-text-success","name","checkmark-circle-outline","slot","start",4,"ngIf"],["class","ion-text-danger","name","close-circle-outline","slot","start",4,"ngIf"],["name","checkmark-circle-outline","slot","start",1,"ion-text-success"],["name","close-circle-outline","slot","start",1,"ion-text-danger"],["color","primary",3,"click"]],template:function(o,t){1&o&&(s.TgZ(0,"ion-header"),s.TgZ(1,"ion-toolbar",0),s.TgZ(2,"ion-buttons",1),s._UZ(3,"ion-back-button",2),s.qZA(),s.TgZ(4,"ion-title"),s._uU(5,"Doctor details"),s.qZA(),s.qZA(),s.qZA(),s.TgZ(6,"ion-content"),s.TgZ(7,"ion-grid"),s.TgZ(8,"ion-row"),s.TgZ(9,"ion-col",3),s.YNc(10,k,1,0,"ion-spinner",4),s.YNc(11,I,12,5,"ion-card",5),s.qZA(),s.qZA(),s.YNc(12,y,4,0,"ion-row",5),s.qZA(),s.qZA()),2&o&&(s.xp6(10),s.Q6J("ngIf",t.isLoading),s.xp6(1),s.Q6J("ngIf",!t.isLoading||t.doctor),s.xp6(1),s.Q6J("ngIf",!t.isLoading))},directives:[d.Gu,d.sr,d.Sm,d.oU,d.cs,d.wd,d.W2,d.jY,d.Nd,d.wI,p.O5,d.PQ,d.PM,d.gZ,d.tO,d.FN,d.q_,p.sg,d.Ie,d.Q$,d.gu,d.YG],styles:[""]}),o})()}];let C=(()=>{class o{}return o.\u0275fac=function(t){return new(t||o)},o.\u0275mod=s.oAB({type:o}),o.\u0275inj=s.cJS({imports:[[i.Bz.forChild(H)],i.Bz]}),o})();var N=n(4466);let w=(()=>{class o{}return o.\u0275fac=function(t){return new(t||o)},o.\u0275mod=s.oAB({type:o}),o.\u0275inj=s.cJS({imports:[[N.m,C]]}),o})()}}]);